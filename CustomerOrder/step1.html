<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="keywords" content="宁波飞扬旅行社,宁波旅行社,宁波旅游网" />
    <meta name="description" content="飞扬旅游网隶属于浙江飞扬国际旅游集团,宁波旅行社行业第一,全国第八,浙江省首批五星级旅行社,宁波市最佳旅行社.服务热线:4000-365-666" />
    <meta name="apple-mobile-web-app-title" content="飞扬旅游网" />
    <title>飞扬旅游网</title>
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/framework7.material.css">
    <link rel="stylesheet" href="/css/my-app.css">
    <link rel="stylesheet" href="/css/jin.css">
</head>
<body ontouchstart>
    <div class="views" id="loadDiv" style="display:none;">
        <!--view-main start-->
        <div class="view view-main">
            <!--page start-->
            <div class="page">
                <!--page-content start-->
                <div class="page-content white">
                    <div class="loadingRow" style="background:#66cbff"><img style="margin-top:-20%;" src="../images/loading-ani.gif" alt=""></div>
                </div>
                <!--page-content END-->
            </div>
            <!-- page END-->

        </div>
        <!--view-main END-->
    </div>
    <!--views start-->
    <div class="views" id="contentDiv">
        <!--view-main start-->
        <div class="view view-main">
            <!--page start-->
            <div class="page navbar-fixed">
                <!-- navbar start-->
                <div class="navbar tmBar">
                    <div class="navbar-inner navbar-on-center">
                        <div class="left"><a href="javascript:history.back();" class="back link"> <i class="icon icon-back mr5"></i></a></div>
                        <div class="center sliding t1">定制游</div>
                        <div class="right"></div>
                    </div>
                </div>
                <!-- navbar END-->
                <!--page-content start-->
                <div class="page-content grayBg">
                    <div class="banner mb15">
                        <div class="swiper-custom mb15">
                            <div class="swiper-container">
                                <div class="swiper-pagination"></div>
                                <div id="adList" class="swiper-wrapper">

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="w-panel borderNone">
                        <div class="center border_b ft18 p10">填写订制表单</div>
                        <p class="p10 ft16 border_b line25">出游信息</p>
                        <dl class="cust_list">
                            <dt>目的地：</dt>
                            <dd>
                                <input class="input_txt" type="text" placeholder="请输入您期望的出游目的地（可填写多个以逗号分隔）" name="" id="desStr">
                            </dd>
                            <dt>出发日期：</dt>
                            <dd>
                                <input type="text" class="input_txt calendarB" placeholder="请选择出游时间" readonly id="calendar-default">
                            </dd>
                            <dt style="padding-top:15px;">出游人数：</dt>
                            <dd>
                                <div style="display:inline-block; margin:5px 15px 5px 0;">
                                    <font class="ft16 mr5"> 成人</font> <span class="numPanel">
                                        <a class="numVH disabled" href="javascript:void(0);" id="adultPlus">-</a>
                                        <input type="text" class="form-control vhInput" value="0" name="" id="adultNumStr">
                                        <a class="numVH" href="javascript:addPerson(1);" id="adultAdd">+</a>
                                    </span>
                                </div>
                                <div style="display:inline-block;">
                                    <font class="ft16 mr5"> 儿童</font> <span class="numPanel">
                                        <a class="numVH disabled" href="javascript:void(0);" id="childPlus">-</a>
                                        <input type="text" class="form-control vhInput" value="0" name="" id="childNumStr">
                                        <a class="numVH" href="javascript:addPerson(2);" id="childAdd">+</a>
                                    </span>
                                </div>
                            </dd>
                            <dt>其他要求：</dt>
                            <dd>
                                <textarea class="input_txt" placeholder="您还可以输入其他补充条件（200字以内）" name="" cols="" rows="3" id="remark"></textarea>
                            </dd>
                        </dl>
                        <p class="p10 ft16 border_b line25">联系人信息</p>
                        <dl class="cust_list mb20 short-dl">
                            <dt>姓名：</dt>
                            <dd>
                                <input type="text" name="" placeholder="请输入联系人" class="input_txt" id="nameStr">
                            </dd>
                            <dt>手机：</dt>
                            <dd>
                                <input type="text" name="" placeholder="请输入手机号" class="input_txt" id="phoneStr">
                            </dd>
                            <dt>验证码：</dt>
                            <dd>
                                <input type="text" name="" placeholder="请输入验证码" class="input_txt" id="codeStr">
                                <a id="codeBtn" class="button color-red inline radis0 yzm" href="javascript:sendCode();">发送验证短信</a>
                            </dd>
                            <dt>邮箱：</dt>
                            <dd>
                                <input type="text" name="" placeholder="您可填写邮箱以方便向您发送行程安排" class="input_txt" id="email">
                            </dd>
                        </dl>
                        <p class="center ft14 pinkTxt">
                            提交后，我们的产品设计师将会第一时间联系您！<br>
                            或者您可直接拨打4000-365-666转私人订制游，随时欢迎您的咨询。
                        </p>
                    </div>
                    <div class="space"></div>
                </div>
                <!--page-content END-->
            </div>
            <!-- page END-->
            <div class="toolbar tabbar yd">
                <div class="toolbar-inner groupBar"> <a class="tab-link m1" style="width:40%" href="javascript:telAction();"> <i class="icon tel"></i> <span>电话客服</span> </a> <a class="button button-fill m3" href="javascript:goOrder();" style="width:60%">立即预定</a> </div>
            </div>
        </div>
        <!--view-main END-->
    </div>

    <!-- views end-->

    <script type="text/javascript" src="/js/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="/js/framework7.js"></script>
    <script type="text/javascript" src="/js/kitchen-sink.js"></script>
    <script type="text/javascript" src="/js/command.js"></script>
    <script type="text/javascript" src="/js/recommended.js"></script>     
    <script type="text/javascript" src="/js/mywechat.js"></script>
    <script type="text/javascript">
	var calendarDefault = myApp.calendar({
   			 input: '#calendar-default'
	});
	loadAdInfo(recdAdJson.customerOrder);
	function telAction() {
	    goTel();
	}
	var myPhone;
	function sendCode() {
	    var phone = $("#phoneStr").val(); 	    
	    if (!myphonereg.test(phone)) {
	        alert("请输入有效的手机号码");
	        return;
	    }
	    $.ajax({
	        type: "POST",
	        url: orderCodeUrl + "?ra=" + Math.random() + "",
	        data: "StrMd5=" + md5Str + "&MT=" + phone + "&State=1",
	        dataType: "text",
	        async: true,
	        success: function (myMsg) {
	            if (myMsg != "") {
	                codeTimeAction();
	                myPhone = phone;
	            }
	            else {
	                alert("短信飞到火星去了,暂时收不到 = =!");
	            }
	        },
	        error: function () {
	            return;
	        }
	    });
	}
	var codeTime = 80;
	function codeTimeAction() {
	    codeTime--;
	    if (codeTime > 0) {
	        $("#codeBtn").html(codeTime + "后重新发送");
	        $("#codeBtn").attr("href", "javascript:void(0);");

	        setTimeout('codeTimeAction()', 1000);
	    }
	    else {
	        //重置按钮
	        codeTime = 80;
	        $("#codeBtn").html("发送验证短信");
	        $("#codeBtn").attr("href", "javascript:sendCode();");
	    }
	}
	function subOrder() {
	    var desData = $("#desStr").val();
	    if (desData == "") {
	        alert("请输入您希望去的目的地");
	        return;
	    }
	    var datetime = $("#calendar-default").val();
	    if (datetime == "") {
	        alert("请选择出游时间");
	        return;
	    }
	    if (adultNum == 0) {
	        alert("请选择出游人数");
	        return;
	    }
	    var name = $("#nameStr").val();
	    if (name == "") {
	        alert("请输入联系人");
	        return;
	    }

	    var phone = $("#phoneStr").val();
	    if (!myphonereg.test(phone)) {
	        alert("请输入有效的手机号码");
	        return;
	    }

	    var code = $("#codeStr").val();
	    if (code == "") {
	        alert("请输入验证码");
	        return;
	    }   	    
	    var remarkStr = $("#remark").val();
	    var emailStr = $("#email").val();
	    remarkStr += "(出游时间:" + datetime + ")";
	    $("#loadDiv").show();
	    $("#contentDiv").hide();
	    $.ajax({
	        type: "POST",
	        url: customtourOrderUrl + "?ra=" + Math.random() + "",
	        data: "StrMd5=" + md5Str + "&GADDRName=" + desData + "&UserName=" + name + "&MT=" + myPhone
            + "&Code=" + code + "&AdultCount=" + adultNum + "&ChildCount=" + childNum + "&ContactTime=0&Demand=" + remarkStr,
	        dataType: "text",
	        async: true,
	        success: function (myMsg) {
	            var dataObj = eval("(" + myMsg + ")");
	            if (dataObj != null && dataObj.result == 1) {
	                window.location.href = "step2.html";
	            }
	            else {
	                $("#loadDiv").hide();
	                $("#contentDiv").show();
	                alert("服务器在火星还没回来,请稍后重试 = =!");
	                isSubmit = false;
	                return;
	            }
	        },
	        error: function () {
	            return;
	        }
	    });

	}
	var adultNum = 0;
	var childNum = 0;
	function addPerson(type) {
	    switch (type) {
	        case 1:
	            adultNum++;
	            break;
	        case 2:
	            childNum++;
	            break;
	    }
	    checkSeat();
	}
	function checkSeat() {

	    if (adultNum == 0) {
	        $("#adultPlus").attr("href", "javascript:void(0);");
	        $("#adultPlus").attr("class", "numVH disabled");
	    }
	    else if (adultNum > 0) {
	        $("#adultPlus").attr("href", "javascript:plusPerson(1);");
	        $("#adultPlus").attr("class", "numVH");
	    }
	    if (childNum == 0) {
	        $("#childPlus").attr("href", "javascript:void(0);");
	        $("#childPlus").attr("class", "numVH disabled");
	    }
	    else if (childNum > 0) {
	        $("#childPlus").attr("href", "javascript:plusPerson(2);");
	        $("#childPlus").attr("class", "numVH");
	    }

	    $("#adultNumStr").val(adultNum);
	    $("#childNumStr").val(childNum);
	}
	function plusPerson(type) {
	    switch (type) {
	        case 1:
	            if (adultNum == 0) {
	                return;
	            }
	            else {
	                adultNum--;
	                checkSeat();
	            }
	            break;
	        case 2:
	            if (childNum == 0) {
	                return;
	            }
	            else {
	                childNum--;
	                checkSeat();
	            }
	            break;
	    }
	}
    </script>
</body>
</html>